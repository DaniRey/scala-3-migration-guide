<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Scala 3 Syntax Rewriting · Scala 3 Migration guide</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Introduction"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Scala 3 Syntax Rewriting · Scala 3 Migration guide"/><meta property="og:type" content="website"/><meta property="og:url" content="https://scalacenter.github.io//scala-3-migration-guide/index.html"/><meta property="og:description" content="## Introduction"/><meta property="og:image" content="https://scalacenter.github.io//scala-3-migration-guide/img/scalacenter2x.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://scalacenter.github.io//scala-3-migration-guide/img/scalacenter2x.png"/><link rel="shortcut icon" href="/scala-3-migration-guide/img/dotty-logo.svg"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css"/><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster&amp;display=swap"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Fira+Code:400,700&amp;display=fallback"/><script src="/scala-3-migration-guide/js/scrollSpy.js"></script><link rel="stylesheet" href="/scala-3-migration-guide/css/main.css"/><script src="/scala-3-migration-guide/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/scala-3-migration-guide/"><img class="logo" src="/scala-3-migration-guide/img/dotty-logo-white.svg" alt="Scala 3 Migration guide"/><h2 class="headerTitleWithLogo">Scala 3 Migration guide</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/scala-3-migration-guide/docs/get-started.html" target="_self">User Guide</a></li><li class=""><a href="/scala-3-migration-guide/docs/contributing.html" target="_self">Contribute</a></li><li class=""><a href="https://github.com/scalacenter/scala-3-migration-guide" target="_blank">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Tooling</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Compatibility Reference</h3><ul class=""><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/get-started.html">Introduction</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/compatibility/source.html">Source Level</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/compatibility/classpath.html">Classpath Level</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/compatibility/runtime.html">Runtime</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/compatibility/metaprogramming.html">Metaprogramming</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Tooling</h3><ul class=""><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/tooling/migration-tools.html">Tour of the Migration Tools</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/tooling/scala-3-migration-mode.html">Scala 3 Migration Mode</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/tooling/scala-3-migrate-plugin.html">Scala 3 Migrate Plugin</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/scala-3-migration-guide/docs/tooling/scala-3-syntax-rewrites.html">Scala 3 Syntax Rewriting</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Tutorials</h3><ul class=""><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/tutorials/prerequisites.html">Project Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/tutorials/sbt-migration.html">sbt Migration Tutorial</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/tutorials/kind-projector.html">kind-projector Migration Tutorial</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/tutorials/macro-cross-building.html">Cross-Building a Macro Library</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/tutorials/macro-mixing.html">Mixing Scala 2.13 and Scala 3 Macros</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Incompatibilities</h3><ul class=""><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/incompatibilities/incompatibility-table.html">Incompatibility Table</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/incompatibilities/syntactic-changes.html">Syntactic Changes</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/incompatibilities/dropped-features.html">Dropped Features</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/incompatibilities/contextual-abstractions.html">Contextual Abstractions</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/incompatibilities/other-changed-features.html">Other Changed Features</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/incompatibilities/type-checker.html">Type Checker</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/incompatibilities/type-inference.html">Type Inference</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Compiler Options</h3><ul class=""><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/compiler-options/compiler-options-table.html">Compiler Options Table</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/compiler-options/new-compiler-options.html">New Scala 3 compiler options</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Resources</h3><ul class=""><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/macros/macro-libraries.html">Scala Macro Libraries</a></li><li class="navListItem"><a class="navItem" href="/scala-3-migration-guide/docs/external-resources/moving-from-scala-2-to-scala-3.html">Moving from Scala 2 to Scala 3</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/scalacenter/scala-3-migration-guide/edit/main/docs/tooling/scala-3-syntax-rewrites.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Scala 3 Syntax Rewriting</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="introduction"></a><a href="#introduction" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h2>
<p>Scala 3 gives Scala developers the option to adopt the new (and optional)
<em>significant indentation based syntax</em> (<em>SIB</em> syntax). The existing syntax which
uses curly braces to group expressions remains fully supported, and we will
refer to this syntax as <em>Classic syntax</em>.</p>
<p>Even though we would advise against it, a single code base might mix the two
syntax versions.
A better approach is to choose one and to consistently apply it to all
source code in a code base.</p>
<p>Scala 3 also introduces a new syntax for control structures. The changes
introduced with this new syntax apply to <code>if</code>-expressions, <code>while</code>-loops, and
<code>for</code>-expressions.</p>
<h2><a class="anchor" aria-hidden="true" id="syntax-rewriting-with-the-scala-3-compiler"></a><a href="#syntax-rewriting-with-the-scala-3-compiler" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Syntax rewriting with the Scala 3 compiler</h2>
<p>Converting existing code to use the new syntax by hand would be a tedious
and error-prone task. The good news is that the Scala 3 compiler can do the
hard work for us!</p>
<p>There are 4 possible combinations of the syntax options we covered so far,
and they are all valid.</p>
<table>
<thead>
<tr><th style="text-align:left"></th><th style="text-align:center">Classic Syntax</th><th style="text-align:center">Significant Indentation Based Syntax</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><strong>Classic control structures</strong></td><td style="text-align:center">✅</td><td style="text-align:center">✅</td></tr>
<tr><td style="text-align:left"><strong>New control structures</strong></td><td style="text-align:center">✅</td><td style="text-align:center">✅</td></tr>
</tbody>
</table>
<p>Let's start with showing the compiler options we have available to achieve our goal.
If we simply type <code>scalac</code> on the command line it shows the usage, including all the options.
With the Scala 3 compiler you will find the following five among those options:</p>
<pre><code class="hljs css language-bash">$ scalac
Usage: scalac &lt;options&gt; &lt;<span class="hljs-built_in">source</span> files&gt;
<span class="hljs-built_in">where</span> possible standard options include:
...
-indent&lt;/b&gt;            Allow significant indentation
...
-new-syntax&lt;/b&gt;        Require `<span class="hljs-keyword">then</span>` and `<span class="hljs-keyword">do</span>` <span class="hljs-keyword">in</span> control expressions.
-noindent&lt;/b&gt;          Require classical {...} syntax, indentation is not significant.
...
-old-syntax&lt;/b&gt;        Require `(...)` around conditions.
...
-rewrite&lt;/b&gt;           When used <span class="hljs-keyword">in</span> conjunction with a `...-migration` <span class="hljs-built_in">source</span> version,
                   rewrites sources to migrate to new version.
...

</code></pre>
<p>We can combine one of four syntax related options:<code>-indent</code>, <code>-noindent</code>, <code>-new-syntax</code>,
and <code>-old-syntax</code>, with the <code>-rewrite</code> option to rewrite source code.</p>
<p>To apply these options in an sbt project, set <code>scalacOptions</code>, for example by adding the line:<br>
<code>scalacOptions ++= Seq(&quot;-indent&quot;,&quot;-rewrite&quot;)</code></p>
<p>Let's have a look at how this works by using a small example.</p>
<h2><a class="anchor" aria-hidden="true" id="rewriting-to-_sib_-syntax--new-control-structure-syntax"></a><a href="#rewriting-to-_sib_-syntax--new-control-structure-syntax" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Rewriting to <em>SIB</em> syntax &amp; new Control Structure syntax</h2>
<p>Given the following source code that uses the classic syntax and classic
control structure syntax:</p>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Counter</span> </span>{
  enum <span class="hljs-type">Protocol</span> {
    <span class="hljs-keyword">case</span> <span class="hljs-type">Reset</span>
    <span class="hljs-keyword">case</span> <span class="hljs-type">MoveBy</span>(step: <span class="hljs-type">Int</span>)
  }
}

<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span>(<span class="hljs-params">name: <span class="hljs-type">String</span></span>)</span>

<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Incrementer</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">increment</span></span>(n: <span class="hljs-type">Int</span>): <span class="hljs-type">Int</span>
}

<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">State</span>(<span class="hljs-params">n: <span class="hljs-type">Int</span>, minValue: <span class="hljs-type">Int</span>, maxValue: <span class="hljs-type">Int</span></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">inc</span></span>: <span class="hljs-type">State</span> =
    <span class="hljs-keyword">if</span> (n == maxValue)
      <span class="hljs-keyword">this</span>
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.copy(n = n + <span class="hljs-number">1</span>)
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">printAll</span></span>: <span class="hljs-type">Unit</span> = {
    println(<span class="hljs-string">"Printing all"</span>)
    <span class="hljs-keyword">for</span> {
      i &lt;- minValue to maxValue
      j &lt;- <span class="hljs-number">0</span> to n
    } println(i + j)
  }
}
</code></pre>
<p>Assume that we want to convert this piece of code to <em>SIB</em> syntax &amp; the new control syntax.
Note that we cannot do this in a single step as the compiler disallows simultaneous rewrites of control syntax and <em>SIB</em>/Classic syntax. In other words, the following
combinations of compiler options are not allowed and each results in an error like the one shown:</p>
<ul>
<li><del>-indent -old-syntax</del> -rewrite</li>
<li><del>-no-indent -old-syntax</del> -rewrite</li>
<li><del>-indent -new-syntax</del> -rewrite</li>
<li><del>-noindent -new-syntax</del> -rewrite</li>
</ul>
<pre><code class="hljs css language-bash">$ scalac -indent -old-syntax -rewrite hello.scala
-- Error: hello.scala:1:0 ------------------------------------------------------
1 |
  |^
  |illegal combination of -rewrite targets: -old-syntax and -indent
1 error found
</code></pre>
<p>Instead we have to rewrite syntax one step at a time.</p>
<p>Let's start by moving to <em>SIB</em> syntax. We compile the code with options <code>-indent -rewrite</code> and the result looks as follows:</p>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Counter</span></span>:
  enum <span class="hljs-type">Protocol</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-type">Reset</span>
    <span class="hljs-keyword">case</span> <span class="hljs-type">MoveBy</span>(step: <span class="hljs-type">Int</span>)

<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span>(<span class="hljs-params">name: <span class="hljs-type">String</span></span>)</span>

<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Incrementer</span></span>:
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">increment</span></span>(n: <span class="hljs-type">Int</span>): <span class="hljs-type">Int</span>

<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">State</span>(<span class="hljs-params">n: <span class="hljs-type">Int</span>, minValue: <span class="hljs-type">Int</span>, maxValue: <span class="hljs-type">Int</span></span>)</span>:
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">inc</span></span>: <span class="hljs-type">State</span> =
    <span class="hljs-keyword">if</span> (n == maxValue)
      <span class="hljs-keyword">this</span>
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.copy(n = n + <span class="hljs-number">1</span>)
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">printAll</span></span>: <span class="hljs-type">Unit</span> =
    println(<span class="hljs-string">"Printing all"</span>)
    <span class="hljs-keyword">for</span> {
      i &lt;- minValue to maxValue
      j &lt;- <span class="hljs-number">0</span> to n
    } println(i + j)
</code></pre>
<p>A few things to observe after the switch to <em>SIB</em> syntax:</p>
<ul>
<li>the number of lines was reduced by 4 because of the elimination of
a series of closing curly braces</li>
<li>the classic control structure syntax is unchanged</li>
</ul>
<p>After this first rewrite, we can have the compiler rewrite the control
structures to the new syntax by specifying the <code>-new-syntax -rewrite</code>.
This results in the following version:</p>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Counter</span></span>:
  enum <span class="hljs-type">Protocol</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-type">Reset</span>
    <span class="hljs-keyword">case</span> <span class="hljs-type">MoveBy</span>(step: <span class="hljs-type">Int</span>)

<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span>(<span class="hljs-params">name: <span class="hljs-type">String</span></span>)</span>

<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Incrementer</span></span>:
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">increment</span></span>(n: <span class="hljs-type">Int</span>): <span class="hljs-type">Int</span>

<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">State</span>(<span class="hljs-params">n: <span class="hljs-type">Int</span>, minValue: <span class="hljs-type">Int</span>, maxValue: <span class="hljs-type">Int</span></span>)</span>:
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">inc</span></span>: <span class="hljs-type">State</span> =
    <span class="hljs-keyword">if</span> n == maxValue then
      <span class="hljs-keyword">this</span>
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.copy(n = n + <span class="hljs-number">1</span>)
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">printAll</span></span>: <span class="hljs-type">Unit</span> =
    println(<span class="hljs-string">"Printing all"</span>)
    <span class="hljs-keyword">for</span>
      i &lt;- minValue to maxValue
      j &lt;- <span class="hljs-number">0</span> to n
    do println(i + j)
</code></pre>
<blockquote>
<h3><a class="anchor" aria-hidden="true" id="converting-code-using-a-project-build"></a><a href="#converting-code-using-a-project-build" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Converting code using a project build</h3>
<p>Converting source files one by one using the Scala 3 compiler, is time consuming
(and requires you to specify the class path which can be a hassle). A more
efficient way to do this in bulk is to recompile your code as part of your
build. For example, if you have an sbt based build, simply add the required
options to <code>Compile / scalacOptions</code> and do a clean compilation of your project.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="moving-back-to-classic-syntax"></a><a href="#moving-back-to-classic-syntax" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Moving back to Classic syntax</h2>
<p>Starting from the final result in the previous section, we can move &quot;back&quot;
towards the initial state of our sample code.</p>
<p>Let's rewrite to Classic syntax and retain the new Control Structures syntax.
We can do that by a single rewrite and the <code>-no-indent -rewrite</code> compiler
options with the following result:</p>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Counter</span> </span>{
  enum <span class="hljs-type">Protocol</span> {
    <span class="hljs-keyword">case</span> <span class="hljs-type">Reset</span>
    <span class="hljs-keyword">case</span> <span class="hljs-type">MoveBy</span>(step: <span class="hljs-type">Int</span>)
  }
}

<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span>(<span class="hljs-params">name: <span class="hljs-type">String</span></span>)</span>

<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Incrementer</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">increment</span></span>(n: <span class="hljs-type">Int</span>): <span class="hljs-type">Int</span>
}

<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">State</span>(<span class="hljs-params">n: <span class="hljs-type">Int</span>, minValue: <span class="hljs-type">Int</span>, maxValue: <span class="hljs-type">Int</span></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">inc</span></span>: <span class="hljs-type">State</span> =
    <span class="hljs-keyword">if</span> n == maxValue then
      <span class="hljs-keyword">this</span>
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.copy(n = n + <span class="hljs-number">1</span>)
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">printAll</span></span>: <span class="hljs-type">Unit</span> = {
    println(<span class="hljs-string">"Printing all"</span>)
    <span class="hljs-keyword">for</span> {
      i &lt;- minValue to maxValue
      j &lt;- <span class="hljs-number">0</span> to n
    }
    do println(i + j)
  }
}
</code></pre>
<p>Applying one more rewrite, with compiler options <code>-old-syntax -rewrite</code>, will
take us back to our original code (with the possible exception of some
differences in formatting):</p>
<pre><code class="hljs css language-scala"><span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Counter</span> </span>{
  enum <span class="hljs-type">Protocol</span> {
    <span class="hljs-keyword">case</span> <span class="hljs-type">Reset</span>
    <span class="hljs-keyword">case</span> <span class="hljs-type">MoveBy</span>(step: <span class="hljs-type">Int</span>)
  }
}

<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span>(<span class="hljs-params">name: <span class="hljs-type">String</span></span>)</span>

<span class="hljs-class"><span class="hljs-keyword">trait</span> <span class="hljs-title">Incrementer</span> </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">increment</span></span>(n: <span class="hljs-type">Int</span>): <span class="hljs-type">Int</span>
}

<span class="hljs-keyword">case</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">State</span>(<span class="hljs-params">n: <span class="hljs-type">Int</span>, minValue: <span class="hljs-type">Int</span>, maxValue: <span class="hljs-type">Int</span></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">inc</span></span>: <span class="hljs-type">State</span> =
    <span class="hljs-keyword">if</span> (n == maxValue)
      <span class="hljs-keyword">this</span>
    <span class="hljs-keyword">else</span>
      <span class="hljs-keyword">this</span>.copy(n = n + <span class="hljs-number">1</span>)
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">printAll</span></span>: <span class="hljs-type">Unit</span> = {
    println(<span class="hljs-string">"Printing all"</span>)
    <span class="hljs-keyword">for</span> {
      i &lt;- minValue to maxValue
      j &lt;- <span class="hljs-number">0</span> to n
    }
    println(i + j)
  }
}
</code></pre>
<p>And with this last rewrite, we have come full circle.</p>
<blockquote>
<h3><a class="anchor" aria-hidden="true" id="loss-of-formatting-when-cycling-through-syntax-versions"></a><a href="#loss-of-formatting-when-cycling-through-syntax-versions" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Loss of formatting when cycling through syntax versions</h3>
<p>When formatting tools such as <a href="https://scalameta.org/scalafmt">scalafmt</a> are
used to apply customised formatting to your code, cycling back and forth between
different Scala 3 syntax variants may result in differences when going full circle.</p>
</blockquote>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/scala-3-migration-guide/docs/tooling/scala-3-migrate-plugin.html"><span class="arrow-prev">← </span><span>Scala 3 Migrate Plugin</span></a><a class="docs-next button" href="/scala-3-migration-guide/docs/tutorials/prerequisites.html"><span>Project Prerequisites</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#introduction">Introduction</a></li><li><a href="#syntax-rewriting-with-the-scala-3-compiler">Syntax rewriting with the Scala 3 compiler</a></li><li><a href="#rewriting-to-_sib_-syntax--new-control-structure-syntax">Rewriting to <em>SIB</em> syntax &amp; new Control Structure syntax</a><ul class="toc-headings"><li><a href="#converting-code-using-a-project-build">Converting code using a project build</a></li></ul></li><li><a href="#moving-back-to-classic-syntax">Moving back to Classic syntax</a><ul class="toc-headings"><li><a href="#loss-of-formatting-when-cycling-through-syntax-versions">Loss of formatting when cycling through syntax versions</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer" style="background-color:#224951"><section class="sitemap"><a href="/scala-3-migration-guide/" class="nav-home"><img src="/scala-3-migration-guide/img/dotty-logo-white.svg" alt="Scala 3 Migration guide" width="66" height="58"/></a><div><h5>Docs</h5><a href="
                /scala-3-migration-guide/docs/compatibility.html">User Guide</a><a href="
                /scala-3-migration-guide/docs/contributing.html">Contribute</a></div><div><h5>Community</h5><a href="https://gitter.im/scala/center" target="_blank">Chat on Gitter</a><a href="https://users.scala-lang.org/" target="_blank">Discuss on Scala Users</a></div><div><h5>More</h5><a href="https://github.com/scalacenter/scala-3-migration-guide" target="_blank">GitHub</a></div></section><section class="copyright">Copyright © 2021 Scala Center</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'f77e0c381ea8939fc6c34dc0e17ea492',
                indexName: 'scala-3-migration-guide',
                inputSelector: '#search_input_react'
              });
            </script></body></html>